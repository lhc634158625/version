<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>

</head>

<body>
    <div>
        <ul>
            <li><a href="backend/">进入系统</a></li>
            <li onclick="Login()"><a>用户登陆</a></li>
            <li onclick="GetById()"><a>通过主键查询</a></li>
            <li onclick="GetByFilter()"><a>分页查询</a></li>
            <li onclick="Update()"><a>更新记录</a></li>
            <li onclick="Insert()"><a>插入记录</a></li>
            <li onclick="Delete()"><a>删除记录</a></li>
            <li onclick="GetCount()"><a>获取总数</a></li>

            <li onclick="GetArrangeReport()"><a>获取排班数据</a></li>
            <li onclick="GetSubArrange()"><a>获取排班人员类别</a></li>
            <li onclick="GetPolice()">获取警员信息</li>
        </ul>
    </div>

    <script src="js/jquery/jquery.min.js"></script>
    <script language="javascript">
        var userInfo;
        function Login() {
            var request = {}
            request.nickName = "Admin";
            request.password = "123456";
            PostData("sys/user/login", request, function (result) {
                userInfo = result.data;
                alert(result.data.nickName);
            });
        }

        function GetById() {

            PostData("sys/user/get", 1, function (result) {
                userInfo = result.data;
                alert(result.data.nickName);
            });
        }
        function GetByFilter() {
            var pageFilter = new Object();
            pageFilter.orderField = "Id";
            pageFilter.fromRecord = 0;
            pageFilter.pageSize = 10;
            pageFilter.conditions = [];
            PostData("sys/user/filter", pageFilter, function (result) {

                alert(result.data.length);
            });
        }
        function Update() {
            userInfo.longitude = 118.23456;
            userInfo.latitude = 24.12356
            PostData("sys/user/save", userInfo, function (result) {
                alert("更新成功");
            });
        }
        function Insert() {
            userInfo.id = 0;
            userInfo.nickname = "Test" + Math.floor(Math.random() * 1000);
            userInfo.Name = "Test"
            PostData("sys/user/save", userInfo, function (result) {
                alert("插入成功,id=" + result.data.id);
            });
        }

        function Delete() {
            PostData("sys/user/delete", 2, function (result) {
                alert("删除成功");
            });
        }
        function GetCount() {
            var pageFilter = new Object();
            pageFilter.tableName = "UserInfo";
            pageFilter.conditions = [];

            PostData("base/getRecordCount", pageFilter, function (result) {
                alert(result.data);
            });
        }

        //警员信息
        function GetPolice(){
            var pageFilter = new Object();
            pageFilter.page = 1;
            pageFilter.pageSize = 10;
            PostData("sys/staff/filter", pageFilter, function (result) {
                alert(result.data);
            });
        }

        function GetArrangeReport() {
            var request = new Object();
            request.fromDt = "2014-04-22 00:00:00";
            request.toDt = "2014-04-22 23:00:00";
            //request.stationId=123; //市局
            request.stationId = 492;//同安分局

            PostData("duty/arrange/stationStaff", request, function (result) {
                alert(result.data.length);
            });
        }
        function GetSubArrange() {
            var request = new Object();
            request.fromDt = "2014-04-22 08:00:00";
            request.toDt = "2014-04-22 10:00:00";
            request.stationId = 492 //同安分局
            PostData("dutyService/getSubArrange", request, function (result) {
                alert(result.data.length);
            });
        }
        var _serviceUrl = "http://218.85.92.186:8081/api/";
        function PostData(method, data, callback) {
            var datajson = JSON.stringify(data);
            $(".Mask").show();
            var url = _serviceUrl + method;
            $.ajax({
                cache: false,
                type: "POST",
                async: true,
                headers: { 'token': 'bfb80308-b1cb-4f1c-bf3c-0bae5c7bfb79', "userId": "1" },
                url: url,
                data: datajson, // JSON.stringify(obj),
                contentType: "application/json",
                dataType: "json",
                success: function (result) {
                    console.log(result.data)
                    if (result.code != 0) {
                        alert(result.message);
                        return;
                    }
                    callback(result);
                },
                error: function (xhr) {
                    $(".Mask").hide();
                    /* if (xhr.status == 401) {
                        top.window.location.href = "/backend/login.html?Logout=1";
                    }
                    else
                        console.log(xhr.statusText); */
                    //alert(xhr.statusText);
                }
            });
        }
        function GetData(method, data, callback) {
            // var datajson = JSON.stringify(data);
            $(".Mask").show();
            var url = _serviceUrl + method + "/" + data;
            $.ajax({
                cache: false,
                type: "POST",
                async: true,
                url: url,
                data: datajson, // JSON.stringify(obj),
                contentType: "application/json",
                dataType: "json",
                success: function (result) {

                    if (result.code != 0) {
                        alert(result.message);
                        return;
                    }
                    callback(result);
                },
                error: function (xhr) {
                    $(".Mask").hide();
                    /* if (xhr.status == 401) {
                        top.window.location.href = "/backend/login.html?Logout=1";
                    }
                    else
                        console.log(xhr.statusText); */
                    //alert(xhr.statusText);
                }
            });
        }
    </script>


</body>

</html>